create table customers(customer_id      int,customer_name    varchar(100),customer_pincode int,primary key (customer_id))
create table pincode_areas(pincode   int,area_name varchar(100))
create table orders(order_id     int,customer_id  int,order_date   date,order_amount double,primary key (order_id))
create table name_idx(name        varchar(100),customer_id int,keyspace_id varbinary(16),primary key (name, customer_id))
vexplain trace insert into pincode_areas(pincode, area_name) values (:vtg1 /* INT64 */, :vtg2 /* VARCHAR */), (:vtg3 /* INT64 */, :vtg4 /* VARCHAR */), (:vtg5 /* INT64 */, :vtg6 /* VARCHAR */), (:vtg7 /* INT64 */, :vtg8 /* VARCHAR */), (:vtg9 /* INT64 */, :vtg10 /* VARCHAR */), (:vtg11 /* INT64 */, :vtg12 /* VARCHAR */), (:vtg13 /* INT64 */, :vtg14 /* VARCHAR */), (:vtg15 /* INT64 */, :vtg16 /* VARCHAR */), (:vtg17 /* INT64 */, :vtg18 /* VARCHAR */), (:vtg19 /* INT64 */, :vtg20 /* VARCHAR */), (:vtg21 /* INT64 */, :vtg22 /* VARCHAR */), (:vtg23 /* INT64 */, :vtg24 /* VARCHAR */), (:vtg25 /* INT64 */, :vtg26 /* VARCHAR */), (:vtg27 /* INT64 */, :vtg28 /* VARCHAR */), (:vtg29 /* INT64 */, :vtg30 /* VARCHAR */)
vexplain trace insert into customers(customer_id, customer_name, customer_pincode) values (:vtg1 /* INT64 */, :vtg2 /* VARCHAR */, :vtg3 /* INT64 */), (:vtg4 /* INT64 */, :vtg5 /* VARCHAR */, :vtg6 /* INT64 */), (:vtg7 /* INT64 */, :vtg8 /* VARCHAR */, :vtg9 /* INT64 */), (:vtg10 /* INT64 */, :vtg11 /* VARCHAR */, :vtg12 /* INT64 */), (:vtg13 /* INT64 */, :vtg14 /* VARCHAR */, :vtg15 /* INT64 */), (:vtg16 /* INT64 */, :vtg17 /* VARCHAR */, :vtg18 /* INT64 */), (:vtg19 /* INT64 */, :vtg20 /* VARCHAR */, :vtg21 /* INT64 */), (:vtg22 /* INT64 */, :vtg23 /* VARCHAR */, :vtg24 /* INT64 */), (:vtg25 /* INT64 */, :vtg26 /* VARCHAR */, :vtg27 /* INT64 */), (:vtg28 /* INT64 */, :vtg29 /* VARCHAR */, :vtg30 /* INT64 */), (:vtg31 /* INT64 */, :vtg32 /* VARCHAR */, :vtg33 /* INT64 */), (:vtg34 /* INT64 */, :vtg35 /* VARCHAR */, :vtg36 /* INT64 */), (:vtg37 /* INT64 */, :vtg38 /* VARCHAR */, :vtg39 /* INT64 */), (:vtg40 /* INT64 */, :vtg41 /* VARCHAR */, :vtg42 /* INT64 */), (:vtg43 /* INT64 */, :vtg44 /* VARCHAR */, :vtg45 /* INT64 */), (:vtg46 /* INT64 */, :vtg47 /* VARCHAR */, :vtg48 /* INT64 */), (:vtg49 /* INT64 */, :vtg50 /* VARCHAR */, :vtg51 /* INT64 */), (:vtg52 /* INT64 */, :vtg53 /* VARCHAR */, :vtg54 /* INT64 */), (:vtg55 /* INT64 */, :vtg56 /* VARCHAR */, :vtg57 /* INT64 */), (:vtg58 /* INT64 */, :vtg59 /* VARCHAR */, :vtg60 /* INT64 */), (:vtg61 /* INT64 */, :vtg62 /* VARCHAR */, :vtg63 /* INT64 */), (:vtg64 /* INT64 */, :vtg65 /* VARCHAR */, :vtg66 /* INT64 */), (:vtg67 /* INT64 */, :vtg68 /* VARCHAR */, :vtg69 /* INT64 */), (:vtg70 /* INT64 */, :vtg71 /* VARCHAR */, :vtg72 /* INT64 */), (:vtg73 /* INT64 */, :vtg74 /* VARCHAR */, :vtg75 /* INT64 */), (:vtg76 /* INT64 */, :vtg77 /* VARCHAR */, :vtg78 /* INT64 */), (:vtg79 /* INT64 */, :vtg80 /* VARCHAR */, :vtg81 /* INT64 */), (:vtg82 /* INT64 */, :vtg83 /* VARCHAR */, :vtg84 /* INT64 */), (:vtg85 /* INT64 */, :vtg86 /* VARCHAR */, :vtg87 /* INT64 */), (:vtg88 /* INT64 */, :vtg89 /* VARCHAR */, :vtg90 /* INT64 */)
vexplain trace insert into orders(order_id, customer_id, order_date, order_amount) values (:vtg1 /* INT64 */, :vtg2 /* INT64 */, :vtg3 /* VARCHAR */, :vtg4 /* INT64 */), (:vtg5 /* INT64 */, :vtg6 /* INT64 */, :vtg7 /* VARCHAR */, :vtg8 /* INT64 */), (:vtg9 /* INT64 */, :vtg10 /* INT64 */, :vtg11 /* VARCHAR */, :vtg12 /* INT64 */), (:vtg13 /* INT64 */, :vtg14 /* INT64 */, :vtg15 /* VARCHAR */, :vtg16 /* INT64 */), (:vtg17 /* INT64 */, :vtg18 /* INT64 */, :vtg19 /* VARCHAR */, :vtg20 /* INT64 */), (:vtg21 /* INT64 */, :vtg22 /* INT64 */, :vtg23 /* VARCHAR */, :vtg24 /* INT64 */), (:vtg25 /* INT64 */, :vtg26 /* INT64 */, :vtg27 /* VARCHAR */, :vtg28 /* INT64 */), (:vtg29 /* INT64 */, :vtg30 /* INT64 */, :vtg31 /* VARCHAR */, :vtg32 /* INT64 */), (:vtg33 /* INT64 */, :vtg34 /* INT64 */, :vtg35 /* VARCHAR */, :vtg36 /* INT64 */), (:vtg37 /* INT64 */, :vtg38 /* INT64 */, :vtg39 /* VARCHAR */, :vtg40 /* INT64 */), (:vtg41 /* INT64 */, :vtg42 /* INT64 */, :vtg43 /* VARCHAR */, :vtg44 /* INT64 */), (:vtg45 /* INT64 */, :vtg46 /* INT64 */, :vtg47 /* VARCHAR */, :vtg48 /* INT64 */), (:vtg49 /* INT64 */, :vtg50 /* INT64 */, :vtg51 /* VARCHAR */, :vtg52 /* INT64 */), (:vtg53 /* INT64 */, :vtg54 /* INT64 */, :vtg55 /* VARCHAR */, :vtg56 /* INT64 */), (:vtg57 /* INT64 */, :vtg58 /* INT64 */, :vtg59 /* VARCHAR */, :vtg60 /* INT64 */), (:vtg61 /* INT64 */, :vtg62 /* INT64 */, :vtg63 /* VARCHAR */, :vtg64 /* INT64 */), (:vtg65 /* INT64 */, :vtg66 /* INT64 */, :vtg67 /* VARCHAR */, :vtg68 /* INT64 */), (:vtg69 /* INT64 */, :vtg70 /* INT64 */, :vtg71 /* VARCHAR */, :vtg72 /* INT64 */), (:vtg73 /* INT64 */, :vtg74 /* INT64 */, :vtg75 /* VARCHAR */, :vtg76 /* INT64 */), (:vtg77 /* INT64 */, :vtg78 /* INT64 */, :vtg79 /* VARCHAR */, :vtg80 /* INT64 */), (:vtg81 /* INT64 */, :vtg82 /* INT64 */, :vtg83 /* VARCHAR */, :vtg84 /* INT64 */), (:vtg85 /* INT64 */, :vtg86 /* INT64 */, :vtg87 /* VARCHAR */, :vtg88 /* INT64 */), (:vtg89 /* INT64 */, :vtg90 /* INT64 */, :vtg91 /* VARCHAR */, :vtg92 /* INT64 */), (:vtg93 /* INT64 */, :vtg94 /* INT64 */, :vtg95 /* VARCHAR */, :vtg96 /* INT64 */), (:vtg97 /* INT64 */, :vtg98 /* INT64 */, :vtg99 /* VARCHAR */, :vtg100 /* INT64 */), (:vtg101 /* INT64 */, :vtg102 /* INT64 */, :vtg103 /* VARCHAR */, :vtg104 /* INT64 */), (:vtg105 /* INT64 */, :vtg106 /* INT64 */, :vtg107 /* VARCHAR */, :vtg108 /* INT64 */), (:vtg109 /* INT64 */, :vtg110 /* INT64 */, :vtg111 /* VARCHAR */, :vtg112 /* INT64 */), (:vtg113 /* INT64 */, :vtg114 /* INT64 */, :vtg115 /* VARCHAR */, :vtg116 /* INT64 */), (:vtg117 /* INT64 */, :vtg118 /* INT64 */, :vtg119 /* VARCHAR */, :vtg120 /* INT64 */), (:vtg121 /* INT64 */, :vtg122 /* INT64 */, :vtg123 /* VARCHAR */, :vtg124 /* INT64 */), (:vtg125 /* INT64 */, :vtg126 /* INT64 */, :vtg127 /* VARCHAR */, :vtg128 /* INT64 */), (:vtg129 /* INT64 */, :vtg130 /* INT64 */, :vtg131 /* VARCHAR */, :vtg132 /* INT64 */), (:vtg133 /* INT64 */, :vtg134 /* INT64 */, :vtg135 /* VARCHAR */, :vtg136 /* INT64 */), (:vtg137 /* INT64 */, :vtg138 /* INT64 */, :vtg139 /* VARCHAR */, :vtg140 /* INT64 */), (:vtg141 /* INT64 */, :vtg142 /* INT64 */, :vtg143 /* VARCHAR */, :vtg144 /* INT64 */), (:vtg145 /* INT64 */, :vtg146 /* INT64 */, :vtg147 /* VARCHAR */, :vtg148 /* INT64 */), (:vtg149 /* INT64 */, :vtg150 /* INT64 */, :vtg151 /* VARCHAR */, :vtg152 /* INT64 */), (:vtg153 /* INT64 */, :vtg154 /* INT64 */, :vtg155 /* VARCHAR */, :vtg156 /* INT64 */), (:vtg157 /* INT64 */, :vtg158 /* INT64 */, :vtg159 /* VARCHAR */, :vtg160 /* INT64 */), (:vtg161 /* INT64 */, :vtg162 /* INT64 */, :vtg163 /* VARCHAR */, :vtg164 /* INT64 */), (:vtg165 /* INT64 */, :vtg166 /* INT64 */, :vtg167 /* VARCHAR */, :vtg168 /* INT64 */), (:vtg169 /* INT64 */, :vtg170 /* INT64 */, :vtg171 /* VARCHAR */, :vtg172 /* INT64 */), (:vtg173 /* INT64 */, :vtg174 /* INT64 */, :vtg175 /* VARCHAR */, :vtg176 /* INT64 */), (:vtg177 /* INT64 */, :vtg178 /* INT64 */, :vtg179 /* VARCHAR */, :vtg180 /* INT64 */), (:vtg181 /* INT64 */, :vtg182 /* INT64 */, :vtg183 /* VARCHAR */, :vtg184 /* INT64 */), (:vtg185 /* INT64 */, :vtg186 /* INT64 */, :vtg187 /* VARCHAR */, :vtg188 /* INT64 */), (:vtg189 /* INT64 */, :vtg190 /* INT64 */, :vtg191 /* VARCHAR */, :vtg192 /* INT64 */), (:vtg193 /* INT64 */, :vtg194 /* INT64 */, :vtg195 /* VARCHAR */, :vtg196 /* INT64 */), (:vtg197 /* INT64 */, :vtg198 /* INT64 */, :vtg199 /* VARCHAR */, :vtg200 /* INT64 */)
select customer_id, customer_pincode from customers where customer_name = :customer_name /* VARCHAR */
vexplain trace select customer_id, customer_pincode from customers where customer_name = :customer_name /* VARCHAR */
select c.customer_id, sum(o.order_amount) from customers as c join orders as o on c.customer_id = o.customer_id group by c.customer_id
vexplain trace select c.customer_id, sum(o.order_amount) from customers as c join orders as o on c.customer_id = o.customer_id group by c.customer_id
select c.customer_id, p.area_name from customers as c join pincode_areas as p on c.customer_pincode = p.pincode
vexplain trace select c.customer_id, p.area_name from customers as c join pincode_areas as p on c.customer_pincode = p.pincode
select distinct c.customer_id, c.customer_name from customers as c join orders as o on c.customer_id = o.customer_id where o.order_amount > (select avg(order_amount) from orders)
vexplain trace select distinct c.customer_id, c.customer_name from customers as c join orders as o on c.customer_id = o.customer_id where o.order_amount > (select avg(order_amount) from orders)
select c.customer_id, c.customer_name from customers as c left join orders as o on c.customer_id = o.customer_id where o.order_id is null
vexplain trace select c.customer_id, c.customer_name from customers as c left join orders as o on c.customer_id = o.customer_id where o.order_id is null
select c.customer_id, c.customer_name, sum(o.order_amount) as total_amount from customers as c join orders as o on c.customer_id = o.customer_id group by c.customer_id, c.customer_name order by total_amount desc limit :vtg1 /* INT64 */
vexplain trace select c.customer_id, c.customer_name, sum(o.order_amount) as total_amount from customers as c join orders as o on c.customer_id = o.customer_id group by c.customer_id, c.customer_name order by total_amount desc limit :vtg1 /* INT64 */
select distinct c1.customer_id, c1.customer_name from customers as c1 join orders as o1 on c1.customer_id = o1.customer_id join orders as o2 on c1.customer_id = o2.customer_id where DATEDIFF(o2.order_date, o1.order_date) = :vtg1 /* INT64 */
vexplain trace select distinct c1.customer_id, c1.customer_name from customers as c1 join orders as o1 on c1.customer_id = o1.customer_id join orders as o2 on c1.customer_id = o2.customer_id where DATEDIFF(o2.order_date, o1.order_date) = :vtg1 /* INT64 */
select DATE_FORMAT(order_date, :vtg1 /* VARCHAR */) as `month`, count(distinct customer_id) as unique_customers, count(*) as total_orders, sum(order_amount) as total_sales from orders group by `month` order by `month` asc
vexplain trace select DATE_FORMAT(order_date, :vtg1 /* VARCHAR */) as `month`, count(distinct customer_id) as unique_customers, count(*) as total_orders, sum(order_amount) as total_sales from orders group by `month` order by `month` asc
select order_count, count(*) as customer_count from (select customer_id, count(*) as order_count from orders group by customer_id) as customer_orders group by order_count order by order_count asc
vexplain trace select order_count, count(*) as customer_count from (select customer_id, count(*) as order_count from orders group by customer_id) as customer_orders group by order_count order by order_count asc